<%-include('../include/_adminhead')%>
<link rel="stylesheet" href="/css/w3.css" >
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">  
<body class="w3-light-grey">


    <!-- Top container -->
  <div class="w3-bar w3-top w3-black w3-large" style="z-index:4;height: 50px;">
    <button class="w3-bar-item w3-button w3-hide-large w3-hover-none w3-hover-text-light-grey" onclick="w3_open();"><i class="fa fa-bars"></i>  Menu</button>
    <button class="btn btn-info pull-right" aria-current="page" onclick="adminLogout()" style="margin-right: 10px;margin-top: 6px;">Log Out</button>
  </div>
  <!-- Button trigger modal -->

<nav class="w3-sidebar w3-collapse w3-white" style="z-index:4;width:300px;" id="mySidebar"><br>
    <div class="w3-container w3-row">
      <div class="w3-col s4">
        <img src="https://bootdey.com/img/Content/avatar/avatar6.png" class="w3-circle w3-margin-right" style="width:46px">
      </div>
      <div class="w3-col s8 w3-bar">
        <span>Welcome, <strong>Mike</strong></span><br>
        
      </div>
    </div>
    <hr>
    <div class="w3-container">
      <h5>Dashboard</h5>
    </div>
    <div class="w3-bar-block">
      <a href="#" class="w3-bar-item w3-button w3-padding-16 w3-hide-large w3-dark-grey w3-hover-black" onclick="w3_close()" title="close menu"><i class="fa fa-remove fa-fw"></i>  Close Menu</a>
      <a href="/admin"class="w3-bar-item w3-button w3-padding "> Admin</a>
      <a href="/admin/users"class="w3-bar-item w3-button w3-padding "> User Management</a>
      <a href="/admin/admin-products" class="w3-bar-item w3-button w3-padding">  Product Managemant</a>
      <a  href="/admin/banner" class="w3-bar-item w3-button w3-padding">  Banner Management</a>
      <a  href="/admin/brand" class="w3-bar-item w3-button w3-padding">  Brand Managemant</a>
      <a href="/admin/category" class="w3-bar-item w3-button w3-padding">  Category Management</a>
      <a href="/admin/offer" class="w3-bar-item w3-button w3-padding">  Offer Managemant</a>
      <a href="/admin/coupon" class="w3-bar-item w3-button w3-padding w3-blue">  Coupon management</a>
      <a href="/admin/admin-orders" class="w3-bar-item w3-button w3-padding"> Orders Management</a>
      <a href="/admin/coupon-history" class="w3-bar-item w3-button w3-padding">  Coupon history</a><br><br>
    </div>
  </nav>
    <section style="margin-left: 300px;">
        <div class="container" style="color:white;  padding: 0px 50px 50px 50px;">
            <div class="row mt-4" style="margin-right: 30px;">
                <a href="/admin/coupon-add" class="btn btn-success ml-auto proadd">Add Coupon</a>
            </div>
            <table class="table mt-4">
                <thead>
                    <tr>
                        <th scope="col">Sl.</th>
                        <th scope="col">Coupon-Code</th>
                        <th scope="col">Percentage</th>
                        <th scope="col">Min Purchase</th>
                        <th scope="col">From</th>
                        <th scope="col">To</th>
                        <th scope="col">Status</th>
                        <th scope="col">Action</th>
                    </tr>
                </thead>

                <tbody>
                    <% for ( let i=0; i < coupon.length; i++){ %>
                        <tr>
                            <th scope="row">
                                <%=i+1%>
                            </th>
                            <td>
                                <%=coupon[i].Code%>
                            </td>
                            <td>
                                <%=coupon[i].percentage%> %
                            </td>
                            <td>
                                <%=coupon[i].min%>
                            </td>
                            <td>
                                <%=coupon[i].fromDate.toDateString()%>
                            </td>
                            <td>
                                <%=coupon[i].toDate.toDateString()%>
                            </td>
                            <% if (coupon[i].status) { %>
                                <td>
                                <form action="/admin/coupon-status/<%= coupon[i]._id %>?_method=PATCH" method="post">
                                    <button type="submit" class="btn btn-success" data-mdb-toggle="modal" data-mdb-target="#exampleModal">
                                        enabled
                                    </button>
                                
                                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                                                <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                            </div>
                                            <div class="modal-body">...</div>
                                            
                                                <div class="modal-footer">
                                                    <button type="submit" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                    <button type="submit" class="btn btn-primary">Save changes</button>
                                                </div>
                                            
                                        </div>
                                    </div>
                                </div>
                            </form>
                                </td>
                                <% } else { %>
                                    <td>
                                        <form action="/admin/coupon-status/<%= coupon[i]._id %>?_method=PATCH" method="post">
                                            <button type="submit" class="btn btn-danger" data-mdb-toggle="modal" data-mdb-target="#exampleModal">
                                                disabled
                                            </button>
                                        
                                        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                                                        <button type="button" class="btn-close" data-mdb-dismiss="modal" aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">...</div>
                                                    
                                                        <div class="modal-footer">
                                                            <button type="submit" class="btn btn-secondary" data-mdb-dismiss="modal">Close</button>
                                                            <button type="submit" class="btn btn-primary">Save changes</button>
                                                        </div>
                                                    
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    </td>
                                    <% } %>
                                        <td>
                                            <a href="/admin/coupon-update/<%= coupon[i]._id %>">
                                                <li class="list-inline-item" style="display: grid;width: 50px;">
                                                    <button class="btn btn-success btn-sm rounded-0" type="button" data-toggle="tooltip"
                                                        data-placement="top" title="Edit"><i class="fa fa-edit"></i></button>
                                                </li>
                                            </a>
                                        
                                            <li class="list-inline-item" style="display: grid; width: 50px;">
                                                <button onclick="deleteCoupon('<%=coupon[i]._id %>')"
                                                    class="btn btn-danger btn-sm rounded-0" type="button" data-toggle="tooltip"
                                                    data-placement="top" title="Delete">
                                                    <i class="fa fa-trash"></i></button>
                                            </li>
                                        </td>
                        </tr>
                        <% } %>
                </tbody>
            </table>
        </div>
    </section>
    
        
    </body>
    <script>
        $('#myModal').on('shown.bs.modal', function () {
  $('#myInput').trigger('focus')
})
        // Get the Sidebar
        var mySidebar = document.getElementById("mySidebar");
        
        // Get the DIV with overlay effect
        var overlayBg = document.getElementById("myOverlay");
        
        // Toggle between showing and hiding the sidebar, and add overlay effect
        function w3_open() {
          if (mySidebar.style.display === 'block') {
            mySidebar.style.display = 'none';
            overlayBg.style.display = "none";
          } else {
            mySidebar.style.display = 'block';
            overlayBg.style.display = "block";
          }
        }
        
        // Close the sidebar with the close button
        function w3_close() {
          mySidebar.style.display = "none";
          overlayBg.style.display = "none";
        }
        </script>
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<style>
    html,body,h1,h2,h3,h4,h5 {font-family: "Raleway", sans-serif}
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
        integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js"
        integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF"
        crossorigin="anonymous"></script>
    </body>

    </html>